<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Taller de Computadoras - A-Frame</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component @6.1.0/dist/aframe-event-set-component.min.js"></script>
    <script src="https://unpkg.com/aframe-draggable-component @0.7.0/dist/aframe-draggable-component.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <a-scene>
        <!-- Cargar assets previamente -->
        <a-assets>
            <a-asset-item id="taller-model" src="Models3d/oficina/scene.gltf"></a-asset-item>
            <a-asset-item id="escritorio-model"
                src="Models3d/mesa_de_jantar_code_augusta_doimo_agave_casa/scene.gltf"></a-asset-item>

            <a-asset-item id="pc-model" src="Models3d/pc_-_computer_graphics/scene.gltf"></a-asset-item>

            <a-asset-item id="case-model" src="Models3d/nzxt_h500_pc_case/scene.gltf"></a-asset-item>

            <a-asset-item id="case1-model" src="Models3d/pc_gamer_animation/scene.gltf"></a-asset-item>

            <a-asset-item id="background-model"
                src="Models3d/starry_night_sky_hdri_background_photosphere.glb"></a-asset-item>

            <a-asset-item id="pizzara-model" src="Models3d/track_assets_pizarra.glb"></a-asset-item>

            <a-asset-item id="cpu-model" src="Models3d/computer_processor/scene.gltf"></a-asset-item>
            <a-asset-item id="motherboard-model"
                src="Models3d/asus_strix_b-550-f_gaming_motherboard_realistic/scene.gltf"></a-asset-item>
            <a-asset-item id="ram-model" src="Models3d/kingston_hyperx_fury_black_ram_module.glb"></a-asset-item>
            <a-asset-item id="tarjetaGrafica-model" src="Models3d/nvidia_geforce_rtx_3090.glb"></a-asset-item>
            <a-asset-item id="discoDuros-model" src="Models3d/discos_duros.glb"></a-asset-item>
            <a-asset-item id="discoDuro-model" src="Models3d/wd_green_1tb_hard_disk_hdd.glb"></a-asset-item>
            <a-asset-item id="fuentePoder-model" src="Models3d/power_supply_-_basic.glb"></a-asset-item>
            <a-asset-item id="VentiladorProcesador-model" src="Models3d/pc_cooler_2.glb"></a-asset-item>





        </a-assets>

        <!-- Luz ambiental -->
        <a-light type="ambient" color="#ffffff" intensity="0.7"></a-light>

        <!-- Luz direccional -->
        <a-light type="directional" color="#ffffff" position="-1.448 2.352 6.553" intensity="0.8"></a-light>

        <!-- Cursor personalizado estilo "mouse" -->
        <a-entity id="player" camera look-controls wasd-controls position="1.000 1.500 4.095"
            rotation="0.030 -89.141 0.000">
            <a-entity id="cursor" cursor="rayOrigin: mouse; fuse: false;" position="0 0 -1"
                geometry="primitive: ring; radiusInner: 0.015; radiusOuter: 0.025"
                material="color: #000; opacity: 0.7;">
                <!-- Efecto parpadeo suave -->
                <a-animation attribute="scale" from="1 1 1" to="1.2 1.2 1.2" dur="150" direction="alternate"
                    repeat="indefinite"></a-animation>
            </a-entity>
        </a-entity>


        <!-- Modelo del taller -->
        <a-entity gltf-model="#taller-model" position="-10 3.5 -14" scale="1 1 1" rotation="0 0 0">
        </a-entity>
        <!-- Modelo del escritorio -->
        <a-entity gltf-model="#escritorio-model" position="3.522 -0.191 2.579" scale="1 1 1"
            rotation="-0.465 -89.964  -0.030">
        </a-entity>

        <!-- Escritorio 2 -->
        <a-entity id="escritorio2" gltf-model="#escritorio-model" position="3.546 -0.203 1.480" scale="1.6 1 1"
            rotation="-0.465 179.791 -0.030">
        </a-entity>

        <!-- Escritorio 3 -->
        <a-entity gltf-model="#escritorio-model" position="3.555 -0.201 5.478" scale="1 1 1"
            rotation="-0.465 178.283  -0.030">
        </a-entity>

        <!-- Escritorio 3 -->
        <a-entity gltf-model="#escritorio-model" position="2.612 -0.201 9.751" scale="2 1 1"
            rotation="-0.465 178.283  -0.030">
        </a-entity>

        <!-- Escritorio 4 -->
        <a-entity gltf-model="#escritorio-model" position="2.612 -0.201 -2.233" scale="2 1 1"
            rotation="-0.465 178.283  -0.030">
        </a-entity>

        <!-- PC 1 -->
        <a-entity gltf-model="#pc-model" position="2.515 0.489 10.586" scale="3.860 3.250 3.591"
            rotation="-0.465 178.283 -0.030">
        </a-entity>

        <!-- Case -->
        <a-entity gltf-model="#case-model" position="4.271 1.290 4.116" scale="0.195 0.153 0.178"
            rotation="-0.465 -91.027 -0.030">
            <!-- Box donde se colocará el procesador -->
            <a-box id="case-cpu-slot" color="transparent" depth="0.01" width="0.3" height="0.2"
                position="-1.439 1.610 -0.593" scale="3.720 6.380 2.120" visible="true" opacity="0.4"
                material="color: #FFD700; transparent: true;">
            </a-box>
            <!-- Box donde se colocará el placaMadre -->
            <a-box id="case-motherboard-slot" color="transparent" depth="0.01" width="0.3" height="0.2"
                position="-1.439 0.887 -0.593" scale="14.025 27.572 2.120" visible="true" opacity="0.4"
                material="color: #ff7800; transparent: true;">
            </a-box>
            <!-- Box donde se colocará el Cooler -->
            <a-box id="case-ventilador-slot" color="transparent" depth="0.01" width="0.3" height="0.2"
                position="-1.424 1.198 -0.257" scale="3.720 6.380 2.120" visible="true" opacity="0.4"
                material="color: #ed333b; transparent: true;">
            </a-box>
            <!-- Box donde se colocará el ram -->
            <a-box id="case-ram-slot" color="transparent" depth="0.01" width="0.3" height="0.2"
                position="-0.147 1.611 -0.551" scale="3.720 13.733 2.120" visible="true" opacity="0.4"
                material="color: #9141ac; transparent: true;">
            </a-box>
            <!-- Box donde se colocará el discoDuro -->
            <a-box id="case-discoDuro-slot" color="transparent" depth="0.01" width="0.3" height="0.2"
                position="-1.719 -1.202 -0.511" scale="3.720 6.380 2.120" visible="true" opacity="0.4"
                material="color: #2ec27e; transparent: true;">
            </a-box>
            <!-- Box donde se colocará el tarjetaGrafica -->
            <a-box id="case-tarjetaGrafica-slot" color="transparent" depth="0.01" width="0.3" height="0.2"
                position="-1.975 -0.454 0.856" scale="3.720 6.380 2.120" visible="true" opacity="0.4"
                material="color: #1c71d8; transparent: true;">
            </a-box>
        </a-entity>

        <!-- PC -->
        <a-entity gltf-model="#case1-model" position="-0.279 0.457 10.145" scale="1.594 1.602 1.553"
            rotation="-0.071 88.874 -0.461">
        </a-entity>

        <!-- Fondo -->
        <a-entity gltf-model="#background-model"> </a-entity>

        <!-- Pizarra 1-->
        <a-entity id="pizarra" gltf-model="#pizzara-model" position="1.250 1.628 1.646" scale="0.740 0.640 0.031"
            rotation="0 0 0">
            <!-- Capa interactiva -->
            <a-box color="transparent" depth="0.01" visible="false"></a-box></a-entity>
        <!-- Cpu -->
        <!-- Boton 1 -->
        <a-entity id="cpu" gltf-model="#cpu-model" position="-0.400 2.103 1.716" scale="0.003 0.003 0.003"
            rotation="90 180 180">
            <!-- Capa interactiva -->
            <a-box color="transparent" depth="0.01" visible="false"></a-box>
        </a-entity>
        <!-- Motherboard -->
        <!-- Boton 2 -->
        <a-entity id="motherboard" gltf-model="#motherboard-model" position="0.348 1.810 1.450"
            scale="0.025 0.020 0.025" rotation="90 180 180">
            <!-- Capa interactiva -->
            <a-box color="transparent" depth="0.01" visible="false"></a-box>
        </a-entity>

        <!-- Ram -->
        <!-- Boton 3 -->
        <a-entity id="ram" gltf-model="#ram-model" position="1.033 2.085 1.674" scale="0.025 -0.280 0.170"
            rotation="90 90 180">
            <!-- Capa interactiva -->
            <a-box color="transparent" depth="0.01" visible="false"></a-box>
        </a-entity>

        <!-- Tarjeta Grafica -->
        <!-- Boton 5 -->
        <a-entity id="tarjetaGrafica" gltf-model="#tarjetaGrafica-model" position="2.267 1.798 1.808"
            scale="0.360 0.251 0.170" rotation="-180 180 180">
            <!-- Capa interactiva -->
            <a-box color="transparent" depth="0.01" visible="false"></a-box>
        </a-entity>

        <!-- Disco Duro -->
        <!-- Boton 6 -->
        <a-entity id="discoDuro" gltf-model="#discoDuro-model" position="-0.347 1.294 1.808" scale="0.116 0.126 0.114"
            rotation="90 180 180">
            <!-- Capa interactiva -->
            <a-box color="transparent" depth="0.01" visible="false"></a-box>
        </a-entity>


        <!-- Fuente Poder -->
        <!-- Boton 7 -->
        <a-entity id="fuentePoder" gltf-model="#fuentePoder-model" position="0.268 1.246 1.808"
            scale="0.158 0.126 0.149" rotation="90 180 180">
            <!-- Capa interactiva -->
            <a-box color="transparent" depth="0.01" visible="false"></a-box>
        </a-entity>

        <!-- Fuente Poder -->
        <!-- Boton 8 -->
        <a-entity id="VentiladorProcesador" gltf-model="#VentiladorProcesador-model" position="1.149 1.334 1.808"
            scale="0.001 0.001 0.001" rotation="180 180 180">
            <!-- Capa interactiva -->
            <a-box color="transparent" depth="0.01" visible="false"></a-box>
        </a-entity>


        <!-- Disco Duros -->
        <a-entity id="discoDuros" gltf-model="#discoDuros-model" position="-2.008 0.563 10.145"
            scale="0.117 0.139 0.114" rotation="-180 180 180">
            <!-- Capa interactiva -->
            <a-box color="transparent" depth="0.01" visible="false"></a-box>
        </a-entity>


    </a-scene>
    <script>
        let cpuSeleccionada = null;
        let boxSeleccionado = null;

        function crearOtraCPU() {
            console.log("✅ Se ha creado una nueva CPU");

            // Eliminar CPU previa si existe
            const existingCpu = document.querySelector('.cpu-placed');
            if (existingCpu) {
                existingCpu.parentNode.removeChild(existingCpu);
            }

            // Crear nuevo procesador
            const nuevaCPU = document.createElement('a-entity');
            nuevaCPU.setAttribute('class', 'cpu-placed');

            // Posición sobre el escritorio
            nuevaCPU.setAttribute('position', '2.961 0.885 5.734');

            // Modelo del procesador
            nuevaCPU.setAttribute('gltf-model', '#cpu-model');

            // Escala mediana para cuando se crea
            nuevaCPU.setAttribute('scale', '0.003 0.003 0.003');

            // Rotación inicial
            nuevaCPU.setAttribute('rotation', '90 -90 90');

            // Capa interactiva
            const box = document.createElement('a-box');
            box.setAttribute('color', '#FF0000');
            box.setAttribute('depth', '0.01');
            box.setAttribute('width', '0.2');
            box.setAttribute('height', '0.2');
            box.setAttribute('position', '0 0 -0.005');
            nuevaCPU.appendChild(box);

            // Efecto hover
            nuevaCPU.setAttribute('event-set__mouseenter', 'scale: 1.1 1.1 1.1;');
            nuevaCPU.setAttribute('event-set__mouseleave', 'scale: 1 1 1;');

            // Asignar ID única y tipo
            nuevaCPU.setAttribute('id', 'cpu-nueva');
            nuevaCPU.setAttribute('data-tipo', 'A');

            document.querySelector('a-scene').appendChild(nuevaCPU);

            // Guardar referencia de la CPU seleccionada
            cpuSeleccionada = nuevaCPU;
        }

        function mostrarMensaje(texto, color = '#00ff00') {
            const msg = document.createElement('a-text');
            msg.setAttribute('value', texto);
            msg.setAttribute('position', '0 1.5 -3');
            msg.setAttribute('color', color);
            msg.setAttribute('align', 'center');
            msg.setAttribute('animation__fade', 'property: opacity; from: 1; to: 0; dur: 2000;');
            document.querySelector('a-scene').appendChild(msg);

            setTimeout(() => {
                msg.parentNode.removeChild(msg);
            }, 2000);
        }

        function unirComponentes() {
            if (cpuSeleccionada && boxSeleccionado) {
                const tipoCPU = cpuSeleccionada.getAttribute('data-tipo');
                const tipoBox = boxSeleccionado.getAttribute('data-tipo');

                if (tipoCPU === tipoBox) {
                    const boxPosition = boxSeleccionado.getAttribute('position');

                    // Animación de transición
                    cpuSeleccionada.setAttribute('animation__position', {
                        property: 'position',
                        to: '4.254 1.534 3.828',
                        dur: 1000,
                        easing: 'easeInOutQuad'
                    });

                    cpuSeleccionada.setAttribute('animation__rotation', {
                        property: 'rotation',
                        to: '90 -90 0',
                        dur: 1000,
                        easing: 'easeInOutQuad'
                    });

                    cpuSeleccionada.setAttribute('animation__scale', {
                        property: 'scale',
                        to: '0.001 0.001 0.001',
                        dur: 1000,
                        easing: 'easeInOutQuad'
                    });

                    // Esperar a que termine la animación antes de mostrar el mensaje y eliminar el box
                    setTimeout(() => {
                        mostrarMensaje('✅ Componentes unidos correctamente');
                        // Eliminar el box después de usar
                        if (boxSeleccionado && boxSeleccionado.parentNode) {
                            boxSeleccionado.parentNode.removeChild(boxSeleccionado);
                        }
                    }, 1000);
                } else {
                    mostrarMensaje('❌ Los componentes no son compatibles', '#ff0000');
                }

                cpuSeleccionada = null;
                boxSeleccionado = null;
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            const cursor = document.querySelector('#cursor');
            cursor.setAttribute('raycaster', 'objects: #cpu, .cpu-placed, #case-cpu-slot');

            // Configurar el box del case
            const caseBox = document.querySelector('#case-cpu-slot');
            caseBox.setAttribute('data-tipo', 'A');
            caseBox.setAttribute('color', '#FFD700');
            caseBox.setAttribute('opacity', '0.4');


            // Detectar clics
            cursor.addEventListener('click', function (e) {
                const intersection = e.detail.intersection;
                if (!intersection) return;

                const clickedObject = intersection.object.el;

                if (clickedObject.id === 'cpu') {
                    crearOtraCPU();
                } else if (clickedObject.classList.contains('cpu-placed')) {
                    cpuSeleccionada = clickedObject;
                    mostrarMensaje('✅ CPU seleccionada');
                } else if (clickedObject.id === 'case-cpu-slot') {
                    boxSeleccionado = clickedObject;
                    mostrarMensaje('✅ Slot seleccionado');
                    unirComponentes();
                }
            });

            // Capturar tecla Escape para cancelar selección
            document.addEventListener('keydown', function (e) {
                if (e.key === 'Escape') {
                    if (cpuSeleccionada || boxSeleccionado) {
                        cpuSeleccionada = null;
                        boxSeleccionado = null;
                        mostrarMensaje('❌ Selección cancelada', '#ff0000');
                    }
                }
            });
        });
    </script>
</body>

</html>